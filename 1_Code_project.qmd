---
title: "Role of sociodemographic factors in the French cinema landscape over the last 50 years "
author: "Kylian SANTOS and Cédric BAZILE"
format: html
editor: visual
execute :
  echo: FALSE
  warning: FALSE
---

<br>

<center>

### Github link

</center>

<center><https://github.com/KylianSts/CNC_INSEE_project></center>

<br>

```{r Configuration, message=FALSE}
here::i_am("CNC_INSEE_project.Rproj")
library(here)
library(readxl)
library(dplyr)
library(tidyr)
library(data.table)
library(ggplot2)
library(scales)
library(plotly) #plotly will allow us to create interactive graph

#Package for maps
library(sf)
library(ggspatial)
library(tmap)
#Note for Mister Rossy : if you do not have the tmap package, one of the document that we use as inspiration to create the interactive maps recommend to install tmap's development version from the r-universe repository : install.packages("tmap", repos = c("https://r-tmap.r-universe.dev", "https://cloud.r-project.org"))
library(tmaptools)

#Package for econometrics
library(plm) 
library(lmtest)
library(tseries)
library(sandwich)
library(car)
library(texreg)
```

# A presentation of the project

## Sources

This project is mainly powered by two databases :

-   CNC's "**Exploitation - data by department**" : <https://www.cnc.fr/cinema/etudes-et-rapports/exploitation--donnees-par-departement_223440>

-   INSEE's "***Harmonized population census data from 1968***" : <https://www.insee.fr/fr/statistiques/6671801?sommaire=2414232>

<br>

### "***Exploitation - data by department***"

*Original french name : "**Exploitation - données par département**"*

The first database was created by the French National Center for Cinema and the Moving Image, most commonly known as CNC. The CNC is an agency of the French Ministry of Culture. Its role is to implement the state's policy on the question of cinema, audiovisual and multimedia. It is notably in charge of the regulation, promotion and distribution of French movies.

In the execution of its mission, the French agency also collects data regarding its purview and proposes part of them in open access. The database "Exploitation - data by department" is one of the aforementioned open data. It is a statistical monitoring of the evolution of French movie theaters and their attendance between 1966 and 2022. Notably, it contains data on the number of venues, their characteristics - e.g. number of screens, seating capacity, ...; but also on the number of sold tickets and gained revenues. As its name indicates, French departments - according to their 2021 administrative division - are the statistical unit of the data. The CNC's data is constructed by using two primary sources :

-   the **list of movie theaters** authorized by the agency

-   and their "bordereaux des recettes" which can be roughly translated by "**revenue slips**"

<br>

### "***Harmonized population census data from 1968***"

*Original title : Données harmonisées des recensements de la population à partir de 1968*

The second database was produced by Insee, the french National Institute of Statistics and Economic Studies. Insee is French national bureau and one of its major data providers. The data that will be used for this project has for source demographic information which comes from the different population censuses between 1968 and 2019.

```{r Summary_of_the_last_census, message = FALSE}
list_of_census <- data.frame(census = paste0("n°", 1:8),year=c(1968,1975,1982,1990,1999,2008,2013,2019))

list_of_census<- list_of_census |>  pivot_wider(names_from="census",values_from = "year")

list_of_census |> knitr::kable(caption ="French census between 1968 and 2019", format="html", align='c')
```

Censuses are one of the most important data collections taking place in France. Answering their survey is an obligation for all inhabitants under penalty of a fine - article 3 of the Law n°51-711 of 7 June 1951. Historically, population censuses took the form of an exhaustive collect of all French townships during a same year. However, the collection method evolved in 2002. Nowadays, Insee uses a rotational approach. For townships of at least 10 000 inhabitants, 8% of the housing of are interviewed each year. The goal is then to cover 40% of their population over a 5-year period. This 5-year moving sample is then used to estimate demographic data annually. For townships with less than 10 000 inhabitants, the collection is still exhaustive but is not simultaneous. Indeed, it occurs in a fifth of towns each year ensuring that all townships are censused every 5 years. Demographic information between 2 collections is then estimated using data from the nearest one.

The data is collected by face-to-face interviews or-since 2015- via internet surveys.

The database that will be used in this project is an harmonized compilation of data from 8 census databases. Its content includes the number of inhabitants by department and key socio-demographic variables - e.g. age, socio-professional categories, type of professional activity.

It can be downloaded from the [INSEE website](https://www.insee.fr/fr/statistiques/6671801?sommaire=2414232) in a DBF or CSV format.

<br>

### Additional databases

Two complementary dataset play a supporting role in our work :

-   "**Admin Express**" from IGN : a shapefile containing polygons forming a map of the French department. URL : <https://geoservices.ign.fr/adminexpress>

-   and the a dataset named "**Transformation coefficient from one year's Euro or French Franc to another year's Euro or French Franc – Base 2015**" of Insee : we will use it to adjust past monetary values for inflation. URL : <https://www.insee.fr/fr/statistiques/serie/010605954#Telechargement>

## Modification of the original databases

### Formatting and cleaning the Insee database

The two databases underwent transformations to become exploitable for our project. The main problem of the Insee one is that it consumes a lot of RAM because of its size - 3GB. Indeed, some categorical variables have a significant number of "categories"/"levels". For example, the variable on the age of the population contains 120 levels, one by each possible year of life of an individual. As a result, the number of potential combinations, and therefore the number of rows, among all variables is impressively large, contributing to the important size of the database.

```{r Calculation_of_the_number_of_rows_in_Insee_cleanv3 , message = FALSE}

insee_data <- read.csv("Data/INSEE_cleanv3.csv")

insee_data <- insee_data |> select(-X) #we drop X, the column which is an index of each row

insee_data <- insee_data |> filter(nchar(DEP_RES_21) != 3) #We drop oversea department

insee_data <- insee_data |> rename(departement_code = DEP_RES_21, year =  AN_RECENS)

insee_data_clean <- insee_data |> filter(!is.na(AGE_GROUP))

In_nrow <- insee_data_clean |> nrow()
```

Our task was to reduce the number of these combinations in order to downsize the database. To do so, we transform the 120 levels of the variable corresponding to the age into 5 age ranges. Furthermore, we get rid of the variables that were not useful to our project using a group_by function. This allows us to go from a database of more than 50 millions rows to a CSV with `r In_nrow` rows.

The process that we used is detailed in the quarto document entitled "Parallel_code_Insee" that is available in this R project. We have preferred to put it in a separate QMD because of the size of the database linked with its code.

<br>

### Formatting and cleaning of the CNC database

The CNC's data was less memory-consuming. However, its format was not convenient for coding with R. Indeed, the original XSLX document put each variable in an independent sheet. In the codes below, we merge all this independent sheets into one uniform database.

```{r Cleaning_formating_function, message = FALSE}
file_path <- "Data/exploitation_données_par_département.xlsx"

# Function to read and process a sheet
read_and_process_sheet <- function(sheet_index) {
  cnc_data <- read_excel(file_path, sheet = sheet_index, skip = 5) |>
    select(-2) |>
    rename(departement_code = 1) |>
    pivot_longer(cols = -departement_code, 
                 names_to = "year", 
                 values_to = excel_sheets(file_path)[sheet_index])
  
  return(cnc_data)
}
```

```{r Cleaning_CNC_database, message = FALSE}

cnc_data_merge <- read_and_process_sheet(4)

for (i in seq(from = 5, to = which(excel_sheets(file_path) == "tmofAE"))) {
  cnc_data_merge <- left_join(cnc_data_merge, read_and_process_sheet(i),
                              by = c("departement_code", "year"))
}
```

As mentioned above, the original XSLX file has multiple sheets. Each sheet is equivalent to a variable and has :

-   rows as departements

-   and columns as years.

To facilitate the merger of each sheets, the initial step was to rename the first column so that we make sure that each sheet shares the same name. This task was performed by the codes above. Then, the second column which is the department was dropped. It permit us to start the merger.

```{r Suppression_of_total_rows, message = FALSE}
cnc_data_clean <- cnc_data_merge |>
  filter(!is.na(departement_code))
```

Additionally, each sheet includes a row which represents the total. We preferred to exclude it in order to simplify next statistical treatment.

```{r replace_NA_by_0_multiplexes, message = FALSE}
multiplexes_with_0 <- cnc_data_clean |> 
  select(multiplexes, year, departement_code) |> 
  pivot_wider(names_from = year, values_from = multiplexes) |> 
  mutate(across(where(~any(!is.na(.))), ~ifelse(is.na(.), 0, .))) |> 
  pivot_longer(cols = -departement_code, names_to = "year", values_to = "multiplexes")

cnc_data_clean <- cnc_data_clean |> select(-multiplexes) 
  
cnc_data_clean <- left_join(cnc_data_clean, multiplexes_with_0, by = c("departement_code", "year"))
```

In the original "Multiplexes" sheet, NA value were assigned when there were 0 multiplexes. We replaced this NA value with 0. and ensured that this replacement only occurs for the year when data had been collected.

```{r Dropped_redundant_variables}
rme <- cnc_data_clean |> select(departement_code, year, RME)
rmeAE <- cnc_data_clean |> select(departement_code, year, RMEAE)
tmof <- cnc_data_clean |> select(departement_code, year, `taux d'occupation des fauteuils`)
tmofAE <- cnc_data_clean |> select(departement_code, year, tmofAE)

cnc_data_clean <- cnc_data_clean |> select(-`indice de fréquentation`, 
                                           -`indice de fréquentationAE`, 
                                           -RME, 
                                           -RMEAE,
                                           -`taux d'occupation des fauteuils`,
                                           -tmofAE)
```

We exclude redundant variables from the final, cleaned database and retain them in separate variables. This ensures that the excluded variables are preserved for future reference, eliminating the need to recalculate them later on.

<br>

## Description of the final bases before merging

The final result is two modified datasets.

**cnc_data_clean**

```{r size_CNC}
cnc_data_clean %>%
  summarize(
      "Number of rows" = prettyNum(nrow(.), big.mark = " "),  
      "Number of columns" = ncol(.)
      ) %>%
  
  knitr::kable(caption = "Description of the CNC database", 
               format = "html", 
               align = 'c')
```

```{r summary_CNC}
cnc_data_clean %>% 
  group_by(year) %>% 
  summarize(
    across(where(is.numeric),list(
      Mean = ~prettyNum(mean(., na.rm = TRUE), big.mark = " "),
      Median = ~prettyNum(median(., na.rm = TRUE), big.mark = " ")
    ))
    ) %>% 
  t() %>%
  knitr::kable(caption = "Statistics of the CNC's variables", format = "html", align = 'c')
```

**insee_data - from Insee_cleanv3.csv -**

```{r Nb_rows_and_columns_Insee}
insee_data_clean %>%
  summarize(
    "Number of rows" = prettyNum(nrow(.), big.mark = " "),
    "Number of columns" = ncol(.)
    )%>%
  
 knitr::kable(caption = "Description of the Insee database", format = "html", align='c')
```

```{r summary_INSEE}
insee_data_clean %>%
  select(-POND2) %>%
  summarize(across(everything(),n_distinct)) %>% 
  t() %>% 
  knitr::kable(caption = "Number of unique values/levels by characteristics variable", format = "html", align = 'c')
```

<br>

### Description of the variables

We have in the CNC database different variables :

-   "**établissement**" represents the **number of movie theaters** for each department
-   "**écrans**" represents the **number of screens,** i.e. movie rooms for each department
-   "**fauteuils**" represents the total **number of seats** in all movie theaters for each department
-   "**multiplexes**" represents the **number of** **multiplexes** for each department . A multiplex is a movie theater complex with multiple screens within a single complex.
-   "**séances**" represents the total **number of seances [in thousand]{.underline}** for each department
-   "**entrées**" represents the total **number of tickets bought [in million]{.underline}** for each department
-   "**recettes**" represents the **total** **revenue in million** for each department
-   "**RME**" represents the **average revenue by bought tickets**
-   "**Taux d'occupation des fauteuils**" is the ratio between **entries during the year and the product between the number of seats and the number of sessions**. Taux d'occupation des fauteuils makes it possible to assess the [**"fullness" of the rooms.**]{.underline}

And we have the same for Arthouse. the term Arthouse refers to so-called auteur films, economically independent, with small budgets, open to the different cultures of the world. An Arthouse cinema is a cinematographic establishment which exhibits a significant proportion of recommended Arthouse films and which supports these often difficult films with an adapted animation policy.

Insee database is a sociodemographic description of each department with variables such as :

-   "**DEP_RES_21**" represents the **department of residence where individuals live**
-   "**AGE_GROUP**" is our computed data representing the **age of the population by range of 15 years**.
-   "**TYP_ACT**" give us the **type of activity** .
-   "**CSP**" is a categorial data that has for levels **socio-professional category**
-   "**POND2**" gives us **the number of** **inhabitants** a**ccording the combination of all previous variables**

<br>

## Merging the INSEE and CNC database

```{r merging}
cnc_data_clean$year <- as.integer(cnc_data_clean$year) 

data_merge <- left_join(cnc_data_clean, insee_data, by = c("departement_code", "year"))

data_clean <- data_merge |>
  filter(!is.na(POND2))
```

<br>

## Research question

A central question will guide our research : **"How has the movie theater landscape in France evolved over the past five decades, and what role have sociodemographic factors played in shaping these transformations?"**

The databases at our disposal will help us to explore this question by looking into the following key aspects:

1.  **Evolution of the Market :** The information provided will help us understand how the movie theater market has evolved in terms of volumes over the last fifty years. One of the key aspects in exploring this question will be to examine the market evolution in terms of venues - établissements. However, the number of movie theaters will not be our sole indicator. Indeed, the number of sessions - séances, seats - fauteuils, and screens - écrans - will be complementary variables that can help us to put under the spotlight potential trends that may not be apparent when solely examining the number of venues. Employing panel data has a dual utility here. It not only enables us to capture the overall temporal trends but also to observe potential cross-sectional differences. Indeed, one of our key objectives is to comprehend whether divergences in trajectories and characteristics exist among the various French departments.

2.  **Structural Shifts with Multiplexes:** A zoom on the multiplexes permits evaluating a recent structural transformation in the movie theater industry. The first one appears in France during the end of the 1990s and can be arguably seen as a shift in the movie theater market. Blanchard ([2014](https://www.cairn.info/revue-migrations-societe-2014-1-page-153.htm)) argues that these facilities "have contributed to the resurgence of attendance, notably by making the movie theater more accessible to suburban residents." Furthermore, despite their relative novelty, they represent an important share of the market industry.

3.  **Economic Health of the Industry:** Variables such as the number of tickets bought - entrées - and total revenue - recettes - will also be complementary and potentially important information. They will notably be key tools for gauging the economic vitality of the industry and determining if the economic dynamics align with the stock of venues, seats, and their past investments.

4.  **Cultural Diversity through Arthouse Cinemas:** The representation of Arthouse cinemas in our dataset highlights the emergence of a cultural niche. Examining the growth and audience engagement of these movie theaters provides insights into the supply and demand for culturally diverse content.

5.  **Demographic Dynamics :** The inclusion of variables from the INSEE database is a key step in our investigation. Utilizing information on age groups (AGE_GROUP) and socio-professional categories (CSP) will enable us to discern whether correlations exist between the demographic composition of the population and the trajectories of distinct departmental markets.

In essence, our research delves into the recent history of movie theaters in France in order to explore the connection between their evolution and sociodemographic factors, while taking into account departmental heterogeneity.

<br>

\newpage

# Evolution of the movie theater market in time : a description of the major trend

## Introduction : the "golden age" of the first half of the 20th century

The history of the movie theater market unfolds on a winter day. In December 28th 1895, two brothers August and Louis Lumiere gave the first commercial public screening. Because a good history is full of happy coincidences, it is in France - our studied country, at the Salon Indien du Grand Café in Paris that the two brothers used their *cinématographe*.

![](Pictures%20and%20illustrations/cinema-lumiere.jpg){fig-align="center"}

The movie theaters market experienced growth relatively quickly. According to Muhlberger (2013) it already became a mass leisure activity in Franc in 1920s but also in the USA and numerous European countries. However, it fully blossomed in the Hexagone a decade later. The period between 1929 and 1957 is often described as a golden age for movie theater in France. Movie theaters attendance reached its zenith, with peaks beyond 400 millions entries. In a report for the French Senate, Thiolliere and Ralite (2003) link this fast period with the introduction of talking films.

<br>

The importance of movie theater during this period maybe underestimated by our contemporary eyes. However, the two senatorial rapporteurs explain that :

" until the advent of the 'petite lucarne' - i.e. television - in households, movie theater had a monopoly on the broadcasting of images. People frequented the theater, not to see a film, but rather to watch a program consisting of one or more short films, news, the trailer for the next film and, after the intermission and advertising, of the 'feature film'."

<center>*THIOLLIERE Michel & RALITE Jack au nom de la Commission des affaires culturelles du Sénat, 2003.* L'évolution du secteur de l'exploitation cinématographique, Rapport d'information sénatoriale n°308 (2002-2003)</center>

<br>

As in many stories, this golden age was not eternal. Ours knew its dawn in 1957. Attendance start to collapsed and more than halved between 1957 and 1966. The arrival of television is often cited as - not the sole - but a pivotal factor in this decline.

<br>

## Evolution of movie theater in France from 1966 to 2022 : a global perspective

<br>

### "Act 1, Scene 1" - The decline continues \[1966-1992\]

#### Evolution of the attendance and revenue

```{r Aggregate_of_attendance_by_year}
Attendance_nat <- cnc_data_clean %>% 
  group_by(year) %>% 
  summarize(Attendance = sum(entrées, na.rm = TRUE)) %>% 
  mutate(Growth = c(NA, ((Attendance[2:n()]/Attendance[1:(n()-1)]) - 1) * 100)) %>%
  round(digits = 2)
```

```{r}
# Function to calculate growth rate
calculate_growth_rate <- function(data, start_year, end_year) {
  subset_data <- data %>%
    filter(year %in% c(start_year, end_year)) %>%
    select(-Growth)

  growth_rate <- subset_data %>%
    reframe(Growth = (Attendance - shift(Attendance, type = "lag")) / shift(Attendance, type = "lag")  * 100) %>%
    filter(!is.na(Growth)) %>%
    pull(Growth) %>%
    round(digits = 2)

  return(growth_rate)
}

Growth_rate_1966_1992 <- calculate_growth_rate(Attendance_nat, 1966, 1992)
Growth_rate_1982_1992 <- calculate_growth_rate(Attendance_nat, 1982, 1992)
Growth_rate_1966_1969 <- calculate_growth_rate(Attendance_nat, 1966, 1969)

#Calculation of the average growth rate between 1966 and 1992

nrow_1966_1992 <-
  Attendance_nat %>% 
  filter(year<1993) %>% 
  nrow()

Av_Growth_rate_1966_1992 <- Attendance_nat %>% 
  filter(year %in% c(1966,1992)) %>% 
  select(-Growth) %>% 
  mutate(Growth = ((Attendance / shift(Attendance, type = "lag") )^(1/nrow_1966_1992) - 1) * 100) %>% 
  filter(!is.na(Growth)) %>% 
  pull(Growth) %>%
  round(., digits=1)
```

Our analytic journey starts in 1966. The CNC's data shows that trend that was observed between 1957 and 1966 continued over the next 26 years. Indeed, between 1966 and 1992, attendance was halved (`r Growth_rate_1966_1992` % with an average growth rate of `r Av_Growth_rate_1966_1992` % during the period). The movie theater market experienced especially two periods of sharp decline. From1966 to 1969, attendance dropped by `r abs(Growth_rate_1966_1969)` %. Movie theaters witnessed 234 millions of entries in 1966 but only 183 millions in 1969. Similarly, in the decade spanning from1982 and 1992, attendance fell from 201 million to 115 million felt, representing a `r abs(Growth_rate_1982_1992)` % decrease.

```{r}
#Graphic of the evolution of attendance in time

Att_graph1 <- Attendance_nat %>% 
  filter(year < 1993) %>% 
  ggplot(aes(x = year, y = Attendance)) +
  geom_line(color="orange", linewidth = 0.75) +
  labs(title ="Attendance in France by year [1966-1992] - Dynamic graph", x="Year", y="Attendance")+
  theme_classic()

ggplotly(Att_graph1, dynamicTicks = TRUE)
```

<br>

18 of the 26 years between 1966 - not included - and 1992 - included - are characterized by a negative attendance's growth rate. On single factor can not be point as the responsible of this degrowth because its causes are multifactorial. However, democratization of television and of automobile are however presented as key factors of this decay.

```{r}
#Graphic of the Growth by year

Att_graph2 <-Attendance_nat %>% 
  filter(year < 1993) %>% 
  mutate(Growth_rate=ifelse(Growth<0, "Negative", "Positive")) %>% 
  ggplot(aes(x = year, y = Growth, fill=Growth_rate)) +
  geom_col() +
  scale_fill_manual(values = c("lightblue", "orange")) +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) + 
  labs(title = "Growth rate by year [1967-1992]", x="Year", y="Growth rate by year", fill="Trend indicator") +
  theme_classic()

ggplotly(Att_graph2)
```

```{r}
att_dep_1 <- cnc_data_clean %>%
  group_by(departement_code, year) %>%
  filter(year == 1966 | year == 1972 | year == 1977 | year == 1982 | year == 1988 | year == 1992) %>%
  summarise(attendance_dep = sum(entrées))

base_year <- att_dep_1 %>%
  filter(year == 1966) %>%
  select(-year) %>%
  rename(base=attendance_dep)

att_dep_1 <- left_join(att_dep_1,base_year, by= 'departement_code') %>%
  mutate(attendance_evolution = (attendance_dep/base - 1)*100)
```

The map below show the evolution of the attendance by department and year in France. Each year show the total growth rate between this year and the 1966 year. One can that the majority of the department are not spare by the decline. However, the trend is not homogeneous by department. The department of the north-east of the Hexagon knew a stronger degrowth of their attendance. At the opposite some departments of Ile-de-France and of the south-east of the territory had a better resilience even knowing significant growth phases.

```{r fig.width=10, fig.height=12}
france_shape <- st_read(dsn = "Maps/ADMIN-EXPRESS/1_DONNEES_LIVRAISON_2023-12-00156/ADE_3-2_SHP_LAMB93_FXX-ED2023-12-19/DEPARTEMENT.shp", stringsAsFactors = FALSE, quiet = TRUE)

france_shape <- france_shape %>% rename(departement_code=INSEE_DEP)

map_data1 <- merge(france_shape, att_dep_1, by = "departement_code")


chosen_breaks <- c(-Inf, -50, -25, 0, 25, 50, Inf)
#After testing numerous ways to create classes for the following map with the style option of tm_fill ("quantile", "pretty", "equal", "headtails") and values for the option n, we chose to define our own classes using the breaks option and style ="fixed". These new classes are inspired by, but diverge from, the values obtained with style="quantile" (while conducting parallel tests with n=) for values under 100. For values above 100, arbitrary classes were created to emphasize the divergence of trajectories of department with positive growth, which quantile had difficulty capturing due to the smaller sample of values above 100.".

  
tm_shape(map_data1) +
tm_fill(fill="attendance_evolution", style = "fixed", breaks=chosen_breaks, palette="-RdYlBu", midpoint=0) +
tm_borders() +
tm_facets(by = "year", nrow = 2, ncol = 3)+
tm_compass(type="8star",position=c("RIGHT","TOP"),show.labels = 1, size =3)+
tm_scalebar(position=c("left","bottom"))+
tm_title_out(text ="Evolution of the attendance relatively to 1966 in percentage",  position = tm_pos_out("center", "top"))+
 tm_style("white")
```

<br>

#### Evolution of the market

```{r Statistics_on_revenue}
recette_nat <- cnc_data_clean %>% 
  group_by(year) %>% 
  summarize(recette_tot = sum(recettes, na.rm = TRUE))

recette_AE_nat <- cnc_data_clean %>% 
  group_by(year) %>% 
  filter(!is.na(recettesAE)) %>%
  summarize(recetteAE_tot = sum(recettesAE, na.rm = TRUE))
```

```{r}
# Load and preprocess an inflation database to adjust monetary values to the year 2015,
# ensuring proper comparison of financial data across different years.

inflation_fr <- read.csv("Data/valeurs_annuelles.csv", sep=";", skip = 3) %>%
  select(-3) %>%
  rename(year=1, coef_ratio=2) %>%
  filter(year > 1965 & year < 2023) %>%
  mutate(coef_ratio = 100/coef_ratio)

recettes_without_inflation <- cnc_data_clean %>%
  select(year, recettes, recettesAE) %>%
  left_join(inflation_fr, by = "year") %>%
  mutate(
    recettes = recettes * coef_ratio,
    recettesAE = recettesAE * coef_ratio
  )
```

```{r}
recette_nat_without_inf <-recettes_without_inflation %>% 
  group_by(year) %>% 
  summarize(recette_tot = sum(recettes, na.rm = TRUE)) %>%
  mutate(rme_nat_without_inflation = recette_tot/Attendance_nat$Attendance 
)
```

Intriguingly, despite the observed drop in attendance, the movie of the movie theater industry increases from 1966 to 1982.

```{r}
Re_graph1 <- recette_nat %>% 
  filter(year < 1993) %>% 
  ggplot(aes(x = year, y = recette_tot)) +
  geom_line(color="skyblue", linewidth = 0.75) +
  labs(title ="Revenue of movie theater in France by year [1966-1992]", x="Year", y="Totale Revenue")+
  theme_classic()

ggplotly(Re_graph1, dynamicTicks = TRUE)
```

This rise is consistent even if we adjust revenue for inflation, as we can see in the graph below. However, an equally significany contraction characterized the 80s and 90s.

```{r}

Re_graph2 <- recette_nat_without_inf %>% 
  filter(year < 1993) %>% 
  ggplot(aes(x = year, y = recette_tot)) +
  geom_line(color="skyblue", linewidth = 0.75) +
  labs(title ="Revenue of movie theater in France by year [1966-1992] (in 2015€)", x="Year", y="Totale Revenue")+
    theme_classic()

ggplotly(Re_graph2, dynamicTicks = TRUE)
```

This observed growth during the 70s can be partly explained by a continuous growth of the average revenue by ticket sold – i.e. the price.

```{r}
Re_graph3 <- recette_nat_without_inf %>% 
  filter(year < 1993) %>% 
  ggplot(aes(x = year, y = rme_nat_without_inflation)) +
  geom_line(color="skyblue", linewidth = 0.75) +
  scale_y_continuous(labels = function(x) paste0(scales::comma(x), "€")) +
  labs(title ="Average revenue by ticket sold in France by year [1966-1992] (in 2015€)", x="Year", y="Revenue by Ticket")+
  theme_classic()

ggplotly(Re_graph3)
```

The decade between 1966 and 1993 also witnessed significant structural shifts in the industry. The number of seats strongly declined during this period. While the Hexagon welcomed 2.4 million movie theater seats in 1966, only 93,000 seats characterized the French market in 1992.

```{r Statistics_on_seats_and_screens}
Equip_nat <- cnc_data_clean %>% 
  group_by(year) %>% 
  summarize(Screens = sum(écrans, na.rm = TRUE),
            Seats = sum(fauteuils, na.rm=TRUE),
            Seats_by_screens = Seats/Screens)
```

```{r Graph_number_of_seats}
#Evolution of the number of seats

Se_graph1 <- Equip_nat %>% 
  filter(year<1993) %>% 
  ggplot(aes(x=year, y=Seats)) +
  geom_line(color="red", linewidth = 0.75)+
  labs(title = "Evolution of the number of seats in France by year [1966-1992]", x="Year", y="Number of Seats")+
  theme_classic()

ggplotly(Se_graph1, dynamicTicks = TRUE)
```

<br>

The data on the number of movie theaters is unavailable on our database before 1992. However, we have for hypothesis that part of this decline is due to the foreclosure of movie theaters. Nevertheless, this hypothesis is not sufficient to understand the evolution of the number of seats during this quarter-century.

Indeed, what might be surprising is that, at the same time that the number of seats diminished, the number of screens had a different journey.

Up until 1971, the number of seats and screens followed the same downward trajectory. However, while the number of seats plummeted, the number of screens stabilized and then increased between 1972 and 1985. The graphic below highlights these elements. By utilizing a 1966 base index 100 for both variables, we can focus on their evolution, putting aside the scale effect. The index of the number of seats almost halved from 1972 to 1985. In parallel the index of the number of screens was more than 20 points higher in 1985 than what was observed in 1972. It was even 5 points above the index in 1966. Likewise, despite the fact that the number of screens experienced a period of degrowth between 1986 and 1992, a serious gap exists between the two indexes in 1992.

```{r Graph_Comp_Seats_and_Screens}
#Addition of base index 100 variable
Equip_nat <- Equip_nat %>%  mutate(Screens_b100=Screens/Screens[year==1966]*100, Seats_b100=Seats/Seats[year==1966]*100)


#Comparaison the number of seats and screens
 ## Pivot
 Equip_nat_b100 <- Equip_nat %>% 
   select(year,Screens_b100,Seats_b100) %>% 
   pivot_longer(cols = c(Screens_b100,Seats_b100),names_to = "Variables", values_to =  "Base_index_100")
 
 ##Graphic
 Se_Sc_graph1 <- Equip_nat_b100 %>% 
   filter(year<1993) %>% 
  ggplot(aes(x=year, y=Base_index_100, color=Variables)) +
  geom_line(linewidth = 0.75) +
  scale_color_manual(values = c("blue", "red")) +
  labs(title = "Comparaison of the number of seats and screens (base index 100 in 1966)", x="Year", y="Number of seats")+
  theme_classic()

ggplotly(Se_Sc_graph1, dynamicTicks = TRUE) %>%
    layout(legend = list(x = 0.2, y = -0.2, orientation = "h"))

```

<br>

How can we comprehend these contradictory trends? Thiolliere and Ralite (2003) explained that this paradox can be attributed to a structural change in the movie theater market. Prior to the late '60s, a large portion of the movie theater market was dominated by single-screen movie halls with a substantial number of seats. However, everything changed after the 60s. The second half of the 20th century witnessed a shift from one-room movie halls to halls with fewer seats but a plural number of screens. Thus, some former one-room movie theaters repurposed their spaces to accommodate more screens, and multiroom setups became predominant among newly constructed movie theaters. Thiolliere and Ralite assert that this new structure enabled the industry to intensify its exploitation capabilities in order to offer more choices for its consumers. These new movie theaters had better performance than their one-room predecessors, explaining the gradual disappearance of the latter. This shift can be observed in the ratio of chairs to screens, which can be interpreted as an indicator of the size of the screening room in terms of seats. It experienced a constant decrease since 1969, and ultimately halved by 1992.

```{r Graph_Ratio_Seats_by_Screens}
Se_Sc_graph2 <- Equip_nat %>%
  filter(year<1993) %>% 
  ggplot(aes(x=year,y=Seats_by_screens))+
  geom_line(color = "turquoise", linewidth = 0.75)+
  labs(title = "Ratio of Seats by Screens in France by year [1966-1992]", x="Year", y="Seats by Screen")+
  theme_classic()

ggplotly(Se_Sc_graph2, dynamicTicks = TRUE)
```

<br>

### "Act 2" - The resurgence \[1993-2022\]

#### Evolution of the attendance and revenue

```{r calculation_growth_rates}

Growth_rate_1993_2019 <- calculate_growth_rate(Attendance_nat, 1993, 2019)


#Calculation of the average growth rate between 1966 and 1992

nrow_1993_2019 <- Attendance_nat %>% 
  filter(year>1992 & year<2020) %>% 
  nrow()

Av_Growth_rate_1993_2019 <- Attendance_nat %>% 
  filter(year %in% c(1993,2019)) %>% 
  select(-Growth) %>% 
  mutate(Growth = ((Attendance / shift(Attendance, type = "lag") )^(1/nrow_1993_2019) - 1) * 100) %>% 
  filter(!is.na(Growth))  %>% 
  pull(Growth) %>%
  round(., digits=1)
```

In numerous movies, after a tragic downfall, the hero makes a flamboyant comeback. If this storyline nourishes many movies in theater, it also mirrors the history of the industry. The 25 years between 1993 and 2019 are a period of growth for the movie theater's market. Attendance surge from 130 million to surpass the symbolic bar of the 200 million. The attendance went from 130 million to surpass the symbolic bar of the 200 million. If this level is still lower than what was observed during the "golden age", the upturn is still significant with a growth of `r Growth_rate_1993_2019` % during the period and an average growth of `r Av_Growth_rate_1993_2019` % by year.

```{r Graph_attendance_after_1992}
Att_graph3 <- Attendance_nat %>% 
  filter(year >1992) %>% 
  ggplot(aes(x = year, y = Attendance)) +
  geom_line(color="orange", linewidth = 0.75) +
  labs(title ="Attendance in France by year [1993-2022]", x="Year", y="Attendance")+
  theme_classic()

ggplotly(Att_graph3, dynamicTicks = TRUE)
```

<br>

```{r Graph_growth_rate_after_1992}
Att_graph4 <-Attendance_nat %>% 
  filter(year >1992 & year<2020) %>% 
  mutate(Growth_rate=ifelse(Growth<0, "Negative", "Positive")) %>% 
  ggplot(aes(x = year, y = Growth, fill=Growth_rate)) +
  geom_col() +
  scale_fill_manual(values = c("lightblue", "orange")) +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) + 
  labs(title = "Growth rate by year [1993-2019]", x="Year", y="Growth rate by year", fill="Trend indicator") +
  theme_classic()

ggplotly(Att_graph4)
```

As mentioned earlier, it is important to note and remeber that growth is not uniform across all departments. While it is true that almost every department experienced a period of increase, the western part of the territory, for example, appears to have a stronger and earlier upturn.

```{r}
att_dep_2 <- cnc_data_clean %>%
  group_by(departement_code, year) %>%
  filter(year == 1993 | year == 1998 | year == 2004 | year == 2009 | year == 2014 | year == 2019) %>%
  summarise(attendance_dep = sum(entrées))

base_year <- att_dep_2 %>%
  filter(year == 1993) %>%
  select(-year) %>%
  rename(base=attendance_dep)

att_dep_2 <- left_join(att_dep_2,base_year, by= 'departement_code') %>%
  mutate(attendance_evolution = (attendance_dep/base - 1)*100)
```

```{r fig.width=10, fig.height=12}
map_data2 <- merge(france_shape, att_dep_2, by = "departement_code")

tm_shape(map_data2) +
tm_fill(fill="attendance_evolution", style = "fixed", breaks=chosen_breaks, palette="-RdYlBu", midpoint=0) +
tm_borders() +
tm_facets(by = "year", nrow = 2, ncol = 3)+
tm_compass(type="8star",position=c("RIGHT","TOP"),show.labels = 1, size =3)+
tm_scalebar(position=c("left","bottom"))+
tm_title_out(text ="Evolution of attendance by departement from 1993 to 2019 compare to 1993",  position = tm_pos_out("center", "top"))+
  tm_style("white")
```

Numerous scientific papers and institutional reports agree that this revival is due to the development of multiplexes (Blanchard, 2014 ; CNC, 2013; Muhlberger, 2013; Thiolliere and Ralite, 2003). Theses structures would have reignited consumer interest in movie theaters. <br>

#### Evolution of the structure of the market

The term 'multiplex' has several concurrent definitions. A broad one characterizes multiplexes as movie halls with a large number of screens. Nevertheless, Blanchard (2014) argues that multiplexes cannot be solely summarized by the number of screens. He emphasizes that they also offer a better consumer experience, with enhanced overall comfort in the screening room and access to additional services such as arcades or restaurants. According to this definition, the first multiplex opened in Toulon in 1993. The CNC uses a simpler definition to establish its statistics. It describes multiplexes as movie theaters with at least 8 screens - with this definition, 31 movie theaters met the multiplex criteria in 1992. Despite these differing definitions, both the CNC and Blanchard draw the same conclusion about the significant impact of multiplexes on the market upturn.

Indeed, the last three decades are an era of sustained growth for multiplexes. Their numbers have multiplied by seven between 1993 and 2022.

```{r Statistics_on_etablishment}
Etablissement_nat <- cnc_data_clean %>% 
  filter(!is.na(multiplexes)) %>% 
  group_by(year) %>% 
  summarize(
    nb_multiplex = sum(multiplexes, na.rm = TRUE), 
    nb_etablissement = sum(établissements, na.rm = TRUE),
    share_multiplexe = (nb_multiplex /nb_etablissement)*100,
    nb_etablissements_no_m = nb_etablissement-nb_multiplex
            )
```

```{r}
 M_graph1 <- Etablissement_nat %>% 
  filter(year >1992) %>% 
  ggplot(aes(x = year, y = nb_multiplex)) +
  geom_line(color = "purple", linewidth = 0.75) + 
  labs(title ="Number of multiplexes in France between 1993 and 2022", x="Year", y="Number of Multiplexes")+
  theme_classic()

ggplotly(M_graph1, dynamicTicks = TRUE)
```

<br>

Data on the number of movie theaters were not available in the database before 1992. The existing data seem to reveal 3 phases :

-   a period of growth in the 90s

-   a decline in the number of movie theaters between 2000 and 2014

-   and, a small revival between 2014 and 2018.

However, when observing the number of movie theaters, multiplexes excluded, a different story unfolds before our eyes. The graph below shows the evolution of the number of movie theaters, both with and without multiplexes. It appears that multiplexes accounted for most of the growth in the 1990s. The the number of movie theaters has even plummeted since 2000 when multiplexes are excluded from the count. Nevertheless, it is important to note that our analysis is limited by an element whose significance remains uncertain. Our data do not allow us to distinguish between the outright closure of movie theaters and the transformation of former multiroom movie theaters into multiplexes.

```{r}
Et_graph <- Etablissement_nat %>% 
  rename ("All movie theater"=nb_etablissement, "Movie theater excluding multiplexes" = nb_etablissements_no_m) %>% 
  pivot_longer(cols = c(`All movie theater`, `Movie theater excluding multiplexes`),names_to = "Variables",values_to = "Nb") %>% 
  filter(year<2022) %>% 
  ggplot(aes(x=year,y=Nb, color=Variables)) +
  labs(title = "Number of movie theater in France between 1992 and 2022", x="Year", y="Number of movie theaters")+
  geom_line(linewidth = 0.75)+
  theme_classic() +
  theme(legend.position = "bottom")


ggplotly(Et_graph, dynamicTicks = TRUE) %>%
  layout(legend = list(x = 0.1, y = -0.2, orientation = "h"))
  
#The rename function is used to change (only for the creation of this graphic) the name of the original column which became the values of the column"Variables". The goal behind this transformation is to have more significative name for the two curves in our legend. We also use the layout function to put the legend above the graph because plotly does not take into account theme(legend.position = "top") when it transform the ggplot.
```

<br>

The share of multiplexes in the total number of movie theaters also grew during this period, gaining 9.5 percentage points between 1993 and 2018. Furthermore, while multiplexes account for a tenth of movie theaters, this is not the case for the total number of attendance. They accounted for more than half of the entries in 2012 (Blanchard, 2014).

```{r}
M_graph2 <- Etablissement_nat %>% 
  filter(year >1992) %>% 
  ggplot(aes(x = year, y = share_multiplexe)) +
  geom_line(color="purple", linewidth = 0.75) +
  scale_y_continuous(labels = scales::percent_format(scale = 1))+ 
   labs(title="Share of the multiplexes in the total of movie theater between 1993 and 2022", x="Year", y="Percentage")+
  theme_classic() 

ggplotly(M_graph2)
```

<br>

The development of multiplexes coincides with a rise of the number of screens in the French territory.

```{r}
Sc_graph <- Equip_nat %>% 
  filter(year > 1992) %>% 
  ggplot(aes(x = year, y = Screens)) +
  geom_line(color = "blue", linewidth = 0.75) +
  labs(title = "Number of Screens in France between 1993 and 2022", x = "Year", y = "Number of Screens") +
  theme_classic()

ggplotly(Sc_graph, dynamicTicks = TRUE)
```

<br>

```{r}
Se_diff_rate_1993_2022 <- Equip_nat %>%
  filter(year %in% c(1993, 2022)) %>%  
  select(-Screens) %>% 
  reframe(Growth=(Seats-shift(Seats, type = "lag") )) %>% 
  filter(!is.na(Growth)) %>% 
  pull(Growth)

Se_diff_rate_1993_2022 <- format(Se_diff_rate_1993_2022, big.mark = " ") 

Se_Growth_rate_1993_2022 <- Equip_nat %>%
  filter(year %in% c(1993, 2022)) %>%  
  select(-Screens) %>% 
  reframe(Growth=(Seats-shift(Seats, type = "lag"))/shift(Seats, type = "lag")*100) %>% 
  filter(!is.na(Growth)) %>% 
  pull(Growth) %>% 
  round(.,digits = 0)
```

The number of seats started also to grow again. This growth did not compensate the historical significant decline that marked the second haft of the 20th century, as indicated in the graph below for the 1962-2022. However, it remains highly significant regarding the level observed in 1993. In total, the number of seats increased of `r Se_diff_rate_1993_2022` seats, representing an augmentation of `r Se_Growth_rate_1993_2022` %.

```{r}
#Evolution of the number of Seats
Se_graph2 <- Equip_nat %>% 
  filter(year<2022) %>% 
  ggplot(aes(x=year, y=Seats)) +
  geom_line(color="red", linewidth = 0.75)+
  geom_vline(xintercept = 1993, linetype = "dotted", color = "black")+
  labs(title = "Number of Seats in France between 1962 and 2022", x="Year", y="Number of Seats")+
  theme_classic()

ggplotly(Se_graph2, dynamicTicks = TRUE)

#Evolution of the number of Seats
Se_graph3 <- Equip_nat %>% 
  filter(year>1992 & year<2022) %>% 
  ggplot(aes(x=year, y=Seats)) +
  geom_line(color="red", linewidth = 0.75)+
  labs(title = "Number of Seats in France between 1993 and 2022", x="Year", y="Number of Seats")+
  theme_classic()

ggplotly(Se_graph3, dynamicTicks = TRUE)
```

<br>

```{r}
seance_nat <- cnc_data_clean %>%
  group_by(year) %>%
  filter(!is.na(séances)) %>%
  summarize(nb_seances = sum(séances, na.rm = TRUE),
            nb_etab = sum(établissements, na.rm = TRUE),
            seance_by_etab = nb_seances/nb_etab)
```

Simultaneously, the number of seances was multiplied by two.

```{r}
Seances_graph <- seance_nat %>%
  filter(year > 1992) %>% 
  ggplot(aes(x = year, y = seance_by_etab)) +
  geom_line(color="purple", linewidth = 0.75) +
  labs(title="Number of seances by movie theater between 1993 and 2022", x="Year", y="Seances")+
  theme_classic()

ggplotly(Seances_graph, dynamicTicks = TRUE)
```

During the same period, the price of tickets - adjusted for inflation - tended to decrease. The years 2008 and 2014 stand out as outliers, which can potentially be explained by the economic context of the moment, with the subprime crisis occurring in 2008 and the sovereign debt crisis between 2010 and 2012. Nevertheless, the decrease began largely before these years, starting in the 90s. In reality, the price in facial values did not decrease during the period but rather grew However, they increased at a slower pace than the general level of prices

```{r}
Re_graph5 <- recette_nat_without_inf %>% 
  filter(year > 1992) %>% 
  ggplot(aes(x = year, y = rme_nat_without_inflation)) +
  geom_line(color="skyblue", linewidth = 0.75) +
    scale_y_continuous(labels = function(x) paste0(scales::comma(x), "€")) +
  labs(title ="Average revenue by ticket sold in France by year [1993-2022] (in 2015€)", x="Year", y="Revenue by Ticket")+
  theme_classic()

ggplotly(Re_graph5)
```

With or without adjustment for inflation, revenues have been consistently increasing over the past thirty years, thanks to the rise in audience numbers. Between 1992 and 2010, revenues grew by 500 million dollars. They also showed a peculiar resilience to economic shocks. If small decreases were observed in 2007 at the dawn of the subprime crisis and in 2013 after the sovereign crisis, both were mild and of short duration. It seems to confirm Muhlberger’s work (2013). Indeed, he studied the relationship between attendance and the state of the economy in France between 1992 and 2012 and found that movie theaters were one of the most resilient cultural activities to shifts in economic conditions.

```{r}
Re_graph4 <- recette_nat_without_inf %>% 
  filter(year > 1992) %>% 
  ggplot(aes(x = year, y = recette_tot)) +
  geom_line(color="skyblue", linewidth = 0.75) +
  labs(title ="Revenue of movie theater in France by year [1993-2022] (in 2015€)", x="Year", y="Totale Revenue")+
  theme_classic()

ggplotly(Re_graph4, dynamicTicks = TRUE)
```

### Rising of the arthouse

def doc excel

Classement des établissements " Art et Essai " Le classement Art et Essai des lieux de projection cinématographiques a fait l'objet d'une réforme qui s'applique depuis 2002. Le classement Art et Essai d'un lieu de projection cinématographique repose désormais : - sur un indice automatique indiquant la proportion de séances réalisées avec des films recommandés Art et Essai par rapport au total des séances offertes ; - sur une pondération de cet indice automatique par deux coefficients. D'une part, un coefficient majorateur qui apprécie le nombre de films proposés, la politique d'animation, l'environnement sociologique et l'environnement cinématographique, d'autre part un coefficient minorateur qui prend en compte l'état de l'établissement, la diversité des films Art et Essai proposés, l'insuffisance de fonctionnement (nombre de semaines et de séances hors période de travaux). Le classement se fait désormais par établissement et la référence géographique est l'unité urbaine dans laquelle est situé l'établissement. Le classement est effectué par la Directrice générale du CNC, après avis de la commission du cinéma d'Art et Essai, qui examine les dossiers de demande de classement des établissements pour une année au début de cette même année. Le montant des subventions est fixé en fonction de l'indice résultant des calculs exposés ci-dessus.

```{r}
Attendance_AE_nat <- cnc_data_clean %>% 
  group_by(year) %>% 
  filter(!is.na(entréesAE)) %>%
  summarize(Attendance = sum(entréesAE, na.rm = TRUE)) %>% 
  mutate(Growth = c(NA, ((Attendance[2:n()]/Attendance[1:(n()-1)]) - 1) * 100)) %>%
  round(digits = 2)

```

```{r}
AE_graph1 <- Attendance_AE_nat %>% 
  ggplot(aes(x = year, y = Attendance)) +
  geom_line(color="orange", linewidth = 0.75) +
  scale_y_continuous(labels = scales::number_format())+ 
  labs(title ="Attendance arthouse cinema in France", x="Year", y="Attendance")+
  theme_classic()

ggplotly(AE_graph1, dynamicTicks = TRUE)
```

Peaople get more interested in arthouse cinema

```{r}
AE_graph2 <-Attendance_AE_nat %>% 
  filter(year < 2020 & year > 2002) %>%
  mutate(Growth_rate=ifelse(Growth<0, "Negative", "Positive")) %>% 
  ggplot(aes(x = year, y = Growth, fill=Growth_rate)) +
  geom_col() +
  scale_fill_manual(values = c("lightblue", "orange")) +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) + 
  labs(title = "Growth rate by year [2002-2019]", x="Year", y="Growth rate", fill="Trend indicator") +
  theme_classic()

ggplotly(AE_graph2)
```

```{r}
AE_graph3 <-  recette_AE_nat %>% 
  ggplot(aes(x = year, y = recetteAE_tot)) +
  geom_line(color = "skyblue", linewidth = 0.75) + 
  labs(titre="Totale revenue arthouse cinema in France", x="Year", y="Totale Revenue")+
  theme_classic()

ggplotly(AE_graph3, dynamicTicks = TRUE)
```

```{r}
Etablissement_AE <- cnc_data_clean %>% 
  group_by(year) %>% 
  filter(!is.na(étabAE)) %>%
  summarize(nb_etablissement_AE = sum(étabAE, na.rm = TRUE),
            nb_etablissement = sum(établissements, na.rm = TRUE),
            part_AE = nb_etablissement_AE/nb_etablissement*100)
```

```{r}
AE_graph4 <-  Etablissement_AE %>% 
  ggplot(aes(x = year, y = part_AE)) +
  geom_line(color = "purple", linewidth = 0.75) + 
  labs(titre="Number of arthouse cinema in France", x="Year", y="Number of arthouse cinema")+
  theme_classic()

ggplotly(AE_graph4, dynamicTicks = TRUE)
```

More and more movie theater are considered arthouse cinema.

# Evolution of population in France and their impact on cinema industry

## How population and offer of seats by department had evolved

```{r}
pop_dep <- insee_data_clean %>%
  group_by(departement_code, year) %>%
  summarise(population_dep = sum(POND2))

pop_fr <- insee_data_clean %>%
  group_by(year) %>%
  summarise(population_fr = sum(POND2))

pop_dep <- left_join(pop_dep,pop_fr, by= 'year') %>%
  mutate(per_pop_dep = population_dep/population_fr * 100)

base_year <- pop_dep %>%
  group_by(departement_code) %>%
  filter(year == 1968) %>%
  select(per_pop_dep, departement_code) %>%
  rename(base=per_pop_dep)

pop_dep <- left_join(pop_dep, base_year, by = "departement_code") %>%
  mutate(per_pop_dep_change = (per_pop_dep / base -1)*100)
```

```{r fig.width=10, fig.height=12}
#On regarde l'évolution temporelle de la part de la population de chaque département dans la population pour voir ou se concentre la population dans le temps
map_data3 <- merge(france_shape, pop_dep, by = "departement_code")

ggplot(map_data3, aes(fill = per_pop_dep_change)) +
  geom_sf() +
  scale_fill_viridis_c(option = "C") + 
  labs(title = "Evolution of the relative concentration of the population by department in France ", fill = "Evolution of the relative concentration of the population by department") +
  theme_classic() +
  annotation_scale()+
  annotation_north_arrow(style = north_arrow_nautical, location = "tr", which_north = "true")+
  facet_wrap(~year, ncol = 3)+
  theme(legend.position = "bottom",
        legend.title = element_text(hjust = 0.5))
```

```{r}
seats_dep <- cnc_data_clean %>%
  group_by(departement_code, year) %>%
  summarise(capacité_dep = sum(fauteuils))

seats_fr <- Equip_nat %>%
  select(year, Seats)

seats_dep <- left_join(seats_dep, seats_fr, by= 'year') %>%
  filter(year == 1968 | year == 1975 | year == 1982 | year == 1990 | year == 1999 | year == 2008 | year == 2013  | year == 2019) %>%
  mutate(per_seats_dep = capacité_dep/Seats * 100)
  
base_year <- seats_dep %>%
  group_by(departement_code) %>%
  filter(year == 1968) %>%
  select(per_seats_dep, departement_code) %>%
  rename(base=per_seats_dep)

seats_dep <- left_join(seats_dep, base_year, by = "departement_code") %>%
  mutate(per_seats_dep_change = (per_seats_dep / base -1)*100)
```

```{r fig.width=10, fig.height=12}
#Évolution de la part de la capacité d'accueil du département par rapport à la capacité d'accueil national pour voir où se concentre "l'offre" dans le temps
map_data4 <- merge(france_shape, seats_dep, by = "departement_code")

ggplot(map_data4, aes(fill = per_seats_dep_change)) +
  geom_sf() +
  scale_fill_viridis_c(option = "C") + 
  labs(title = "Evolution of the relative concentration of the offer of seats by department in France", fill = "Evolution of the relative concentration of the offer of seats by department") +
  theme_classic() +
  annotation_scale()+
  annotation_north_arrow(style = north_arrow_nautical, location = "tr", which_north = "true")+
  facet_wrap(~year, ncol = 3)+
  theme(legend.position = "bottom",
        legend.title = element_text(hjust = 0.5))

```

## Explaining the diversity in the temporal evolution of attendance by department : an econometric analysis

In the preceding section, we explored the narrative shaped by the history of movie theaters. A pivotal aspect of this tale was the presence of heterogeneity in the trajectory that each departmental attendance followed. This final section aims is to study whether we can link this heterogeneity with the demographic features of the department and its evolution. Specifically, we will attempt to understand which sociodemographic characteristics had a positive or negative influence on the evolution of attendance over time.

<br>

Studying this interaction can be challenging through the sole use of graphics. The dataset's variables can be affected by complex interactions, and relying solely on plots can lead to spurious conclusions. Moreover, graphical method encounters limitations as the number of variables of interest increases. That’s why the utilization of econometric models can be valuable to perform a more thorough analysis. This section is dedicated to employing econometric methodologies to find answers that address our research question. To achieve this, we will use a panel data econometric model that incorporates both cross-sectional and time series characteristics of our dataset.

<br>

However, we quickly realized that this project was ambitious. At this stage of our academic journey, our technical understanding of econometrics is not sufficient to execute a solid panel regression that would address all the requirements of our dataset. Mastery of panel data is yet beyond our current training and knowledge. Nevertheless, we approached this assignment as a training ground to familiarize ourselves with the procedures for conducting an econometrics analysis on panel data. Therefore, we do not have the pretention to say that our work provided the correct correlation between our explained variable and the sociodemographic features of the department. However, it demonstrates what a procedure for testing and interpreting a longitudinal econometrics model.

<br>

After consulting various sources, our final procedure drew mainly inspiration from Altaf (2017) and a document by Torres-Reyna (2010) for Princeton University. The codes and the process were also influenced by Schmidheiny (2023) and Wagle (2021) papers. Bourbonnais (2020) also contributed significantly to our understanding of part of the theory behind the use of panel data.

<br>

This section is divided into two parts:

1.  The first part is dedicated to the tests and corrections that we used in our model,

2.  The second part discusses the obtained outcomes and emphasizes some limitations that our approach encounters.

### Part 1 : Model and test

```{r Creation_of_the_specific_database_for_the_econometrics_model}

# Importation of the database
insee_econ <- read.csv("Data/INSEE_clean_econ.csv")

insee_econ <- insee_econ  %>%  
  select(-X) %>% filter(nchar(DEP_RES_21) != 3) %>%  
  rename(departement_code = DEP_RES_21, year =  AN_RECENS) 

# Fusion with CNC Data

Econ_data <- left_join(cnc_data_clean, insee_econ, by = c("departement_code", "year"))

Econ_data <- Econ_data %>% 
  filter(!is.na(POND2))


# Number of inhabitant by age range

Econ_data_AG <- Econ_data %>% 
  group_by(departement_code, year, AGE_GROUP) %>% 
  summarise(POND2=sum(POND2)) %>% pivot_wider(names_from = "AGE_GROUP", values_from = "POND2") %>% 
  select(departement_code, year,a_less_than_6, a_6_to_24, a_25_to_42, a_43_to_59, a_60_and_more)

# Number of inhabitant by CSP


Econ_data_CSP <- Econ_data %>%
  group_by(departement_code, year, CSP) %>% 
  summarise(POND2=sum(POND2, na.rm = TRUE)) %>% 
  pivot_wider(names_from = "CSP", values_from = "POND2" ) %>% 
  rename( Farm = "1", Craf_sh_head = "2", Ex_intel = "3", Int_prof = "4", Employees = "5", Workers = "6", Retirees = "8", Ina = "9")

#Final database with AGE_GROUP and CSP
Econ_data_v2 <- Econ_data %>% 
  select(departement_code, year, entrées) %>%
  distinct() %>%  
  left_join(Econ_data_AG, by = c("departement_code", "year"))

Econ_data_v2 <- Econ_data_v2  %>% 
  left_join(Econ_data_CSP, by = c("departement_code", "year"))

```

Our basic model has attendance as the dependent variable, and each classification of socioprofessional categories (CSP) from the Insee terminology serves as independent variables. Specifically, the model is described by the formula below :\
$$
Entrées_{it} = \beta_0 + \beta_1 Farm_{it} + \beta_2 Craf\_sh\_head_{it} + \beta_3 Ex\_intel_{it} + \beta_4 Int\_prof_{it} + \beta_5 Employees_{it} + \beta_6 Workers_{it} + \beta_7 Retirees_{it} + \beta_8 Ina_{it} + u_{it}
$$ Where :

-   $Entrées$ : the attendance

-   $Farm$ : the number of farmers

-   $Craf\_sh\_head$ : the number of artisans, shopkeepers, and business owners

-   $Ex\_intel$ : the number of executives and intellectual Professions

-   $Int\_prof$ : the number of intermediate occupation, i.e. "job between executives and workers or employees or intermediate professions in a more figurative sense" (teachers, nurses, social workers) ([Insee, 2003](https://insee.fr/fr/metadonnees/pcs2003/categorieSocioprofessionnelleAgregee/4?champRecherche=false)).

-   $Employees$ :the number of employees

-   $Workers$ : the number of manual workers

-   $Retirees$ : the number of retirees

-   $Ina$ :the number "inactive individuals and person who have never worked" where we notably find pupils, students and other kind of "inactive" individuals

-   $u$ : the residuals

This Panel Data is such that N = 96 and T = 8 - the 8 years of the french census that are present in the Insee's dataset.

<br>

Various models were tested during the draft of our work, considering factors such as age range, type of activity and combinations of the aforementioned data with CSP. However, we opted for this final model for two reasons. Firstly, it had a good Bayesian information criterion - BIC - score relatively to its counterpart. Secondly, it was the model were the colinearity among explanatory variables was the least strong.

The main part of our econometrics treatment were performed with the **plm** package. By prudence, we selected to apply only basic techniques for the econometric analysis of panel data.

<br>

#### Choice of the type of model

An early step consists to determine which kind of models suits the dataset. Three standards models are often used for panel data :

1.  Regular OLS

2.  Fixed effect model

3.  Random effect model

The plm package's F Test for Individual and/or Time Effects - pFtest - were used to arbitrate between the utilization of a fixed effect model and an OLS. The decision criterion is that if the p-value is below the significance level of 0.05, the fixed effect model is preferred. It is our case here. As we can see below, our F test p-value is under the aforementioned threshold.

```{r Test_between_fixed_effect_and_OLS}

#OLS Model
ols <- plm(entrées ~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2, index=c("departement_code", "year"), model="pooling")

#Fixed effect model
f_eff <-plm(entrées ~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2, index=c("departement_code", "year"), model="within")

# F Test for Individual and/or Time Effects test
pFtest(f_eff, ols)
```

The Haussman test continues our analysis by determining the most suitable model between the fixed effect and the random model. The p-value being below the significance level of 0.05, the fixed effect model is favored.

```{r Test_between_fixed_and_random_effect}
#Random effect model
r_eff <-plm(entrées ~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2, index=c("departement_code", "year"), model="random") 


#Haussman test to determine between fixed and random effect
phtest(f_eff, r_eff)
```

<br>

#### Test for time-fixed effect

Having selected the fixed effect model, the next step was to identify whether the addition of time-fixed effects contribute to the improvement the model's quality.

With p-values below 0.05, both Breusch-Pagan and Honda tests advocate for the addition of time-fixed effect.

```{r test_for_time_fixed_effect}
#Model with time-fixed effects.
f_eff_time <-plm(entrées~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2, index=c("departement_code", "year"), model="within", effect = "time")

#PLM test
plmtest(f_eff_time, effect="time", type="bp")
plmtest(f_eff_time, effect="time", type="honda")
```

We then used a two ways model combining time-fixed and individual effects. Our model became : <br>

$$
Attendance = \beta_0 + \beta_1 Farm_{it} + \beta_2 Craf\_sh\_head_{it} + \beta_3 Ex\_intel_{it} + \beta_4 Int\_prof_{it} + \beta_5 Employees_{it} + \beta_6 Workers_{it} + \beta_7 Retirees_{it} + \beta_8 Ina_{it} + \alpha_{it} + \gamma_{it} + u_{it}
$$

```{r Creation_of_the_two_ways_model}
f_eff_2ways <- plm(entrées~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2, index=c("departement_code", "year"), model="within",effect = "twoways")
```

<br>

#### Test for unit roots

The augmented Dickey-Fuller test enables us to check for unit roots. Its results suggest the presence of stationarity in our data.

```{r Test_for_unit_roots}
Panel.set<- pdata.frame(Econ_data_v2, index = c("departement_code", "year")) 

adf.test(Econ_data_v2$entrées, k=2)
```

<br>

#### Test for serial correlation

Our panel data faces several issues. Firstly, our model suffers from serial correlation. The Breusch-Godfrey/Wooldridge test indicates a p-value below the significance level of 0.05. To address this issue, both Altaf and Torres-Reyna recommend the utilization of Arellano's technique.

```{r Test_for_serial_correlation}
pbgtest(f_eff_2ways)
```

<br>

#### Test of Heterosedasticity

The second challenge in our econometrics analysis was the presence of heteroscedasticity in the model.

```{r #Test_for_heteroscedasticity}
bptest(entrées~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data = Econ_data_v2, studentize=F)
```

"Nevertheless, heteroscedasticity is a common issue in econometric analysis, and various solutions have been proposed to address it. Utilizing the **vcovHC** function from the **sandwich** package enables the computation of heteroskedasticity-consistent covariance estimators employing both White's (1980, 1984) and Arellano's (1987) methods. The argument **'** **method = "arellano"** ' can be employed to simultaneously correct the serial correlation issue discussed earlier

<br>

#### Test for cross-sectional dependence

A final issue was the presence of cross-sectional dependence as we can see on the Breusch-Pagan and Pesaran tests below.

```{r Test_for_cross_sectional_dependence}
#Breusch-Pagan LM test for cross-sectional dependence
pcdtest(f_eff_2ways, test = c("lm"))

#Pesaran test for cross-sectional dependence
pcdtest(f_eff_2ways, test = c("cd"))
```

Altaf proposes the utilization of the Beck and Katz method as a solution to tackle this issue. To implement this method, we will forgo the utilization of the **vcovHC** argument and instead use the **vcovSC** one, which performs the same correction and also enables the correction of cross-sectional dependence.

<br>

#### Temporal division

One of our concerns was how the model would react to the shift in attendance trend. As we saw, the decades preceding 1993 are a period of sharp decline, but the opposite is true after this threshold. Unfortunately, we currently lack the techniques to resolve this issue. However, we tried to have an alternative solution to take into account this issue. Our approach was to add in our analysis two models similar to the main one :

-   One specifically dedicated to the year before 1990 - included, corresponding to the year of the census closest to 1993,

-   One for the period strictly after.

*All the statistics test on these models are included in annex 2 and 3*

```{r Addition_of_the_Model_before_and_after_1990}
#Before 1990
Econ_data_v2_1<- Econ_data_v2 %>% filter(year <= 1990)

f_eff_2ways_b90 <- plm(entrées~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2_1, index=c("departement_code", "year"), model="within",effect = "twoways")

#After 1990 (not included)
Econ_data_v2_2<- Econ_data_v2 %>% filter(year > 1990)

f_eff_2ways_a90 <- plm(entrées~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2_2, index=c("departement_code", "year"), model="within",effect = "twoways")

```

<br>

#### Additional test : Bayesan Information Criterion

During our research phase, another test plays a crucial role: the Bayesian Information Criterion. It holds significant importance in the selection of the final model among the various draft models that were not retained in the analysis. We utilized the formula presented in Yum's paper (2021) on information criterion analysis for model selection in panel data models with fixed effects.

<br> $$
BIC = N \times T \times \log(\sigma^2) + K \times \log(N \times T) 
$$ <br>

With : $\sigma = \frac{SSR}{N \times T}$

<br>

```{r BIC_Calculation}
# SSR
SSR <- sum(residuals(f_eff_2ways)^2)

#N
N_model <- 96


#T
T_model <- 8

#Sigma squared

sigma_squared <- SSR / (N_model * T_model)

# Compute BIC manually

k_model <- length(coef(f_eff_2ways))
bic_value <- N_model * T_model * log(sigma_squared) + k_model * log(N_model * T_model)

# Print the BIC value
print(bic_value)
```

<br>

#### Multicolinearity analysis

To conclude, VIF test show that our model is marked by multicolinearity. Among the model that we tested during our draft work (models with age range, models with various combination of age range, type of activity and CSP), the model using solely CSP seems to be the one where this problem were the least acute. Using instrumental variable

```{r VIF_test}
mvif <-plm(entrées ~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2, index=c("departement_code", "year"), model="pooling")

vif(mvif)
```

<br>

### Part 2 - Discussion The initial regression, performed before implementing the Beck and Katz correction method, provided the results below.

```{r Outcome_before_correction}
summary(f_eff_2ways)
```

In the table, a comparison of coefficients before and after the application of **vcovSCC** with ' **method = "Arellano"** ' is provided. We can remark that the correction of serial correlation, cross-sectional dependence, and heteroscedasticity did not change the coefficients. However, it did impact the standard error and the t-value.

```{r Comparaison_of_standard_model_and_model_with_SCC}

SCC <- coeftest(f_eff_2ways, vcov = vcovSCC(f_eff_2ways, method = "arellano"))

screenreg(list("Basic Model" = f_eff_2ways, "Corrected Model" = SCC))
```

Because of multicollinearity, we preferred to ignore the raw interpretation of the estimate. However, their significance and signs can still give us insights into the potential relationship between CSP and the evolution of attendance. Over the overall 1968-2019 period, the population of employees, artisans, shopkeepers, and business owners seems to have a positive impact on attendance. It is also true for the number of inactive individuals but with a lower significance level. On the other hand, the number of farmers and workers had a negative impact on the evolution of attendance. Some of these outcomes can be interpreted as echoing results observed in other papers. CNC's reports based on its "Médiamétrie" surveys since 1993 (CNC, 2008, 2013, 2016, 2020) found that workers tend to go less often to movie theaters than other CSP. Quoting Bonnel, Thiolliere, and Ralite (2003), they also explained that workers were the movie theater's most loyal audience before the 60s but also the one where its consumption plummeted between the 60s and the 90s.

While being the positive variable with the least significant level, the impact of the number of inactive individuals can also be linked to former CNC surveys’ outcomes. Pupils and students who belong to this CSP are the audience with the highest movie theater consumption.

<br>

The analysis takes a different turn when the model is split into the two aforementioned models. Several variables become insignificant. Conversely, the impact of inactive individuals becomes more significant, which can be linked with the elements that we previously discussed. The manual worker variable, while still significant before 1990, loses its significance afterward. These outcomes can be potentially easily explained. As we discussed, the 60s-90s period is a period of historically lower movie theater attendance by this CSP. However, the introduction of multiplexes, notably because they tend to be in popular areas, may have put the brakes on this decline. Another potential explanation could be that the reduction in their consumption was not continuous but, after a period of decline, a plateau was reached. What is more surprising is that the number of artisans, shopkeepers, and business owners had a negative impact before 1990 and had no impact after in the split models, while its impact is strictly positive in the model of the overall period.

```{r Coefficient_with_correction_of_the_different_issues}
SCC_b90 <- coeftest(f_eff_2ways_b90, vcov = vcovSCC(f_eff_2ways_b90, method = "arellano"))

SCC_a90 <- coeftest(f_eff_2ways_a90, vcov = vcovSCC(f_eff_2ways_a90, method = "arellano"))

screenreg(list("<= 1990" = SCC_b90, "> 1990" = SCC_a90))

```

<br>

These outcomes advocate for the realization of complementary studies. Some of the observed phenomena may also be explained, in part, by limitations inherent with our model. Multicollinearity, as we saw, is one of these issues. However, two other issues deserve attention. One of them is the absence of key control variables. We were particularly eager to incorporate a control variable for television consumption, often cited as a factor in the attendance decline during the 20th century. Unfortunately, we were unable to find data at the departmental level. Furthermore, it is intriguing to explore whether the recent proliferation of streaming services with giants like Netflix, Prime Video, or Disney+ had an impact on cinema attendance. Another limitation of our model arises from the use of linear estimators. Non-linear relationships between our variables could potentially result in spurious coefficients.

<br>

In conclusion, given the limitations of our models, it is not feasible to draw definitive conclusions. Nevertheless, some of the model results align with elements observed in previous surveys and senatorial reports, notably regarding the impact of workers but also pupils and students population on cinema attendance. The idea that the diversity observed in the evolution of attendance in French departments is linked to the dynamics of these populations emerges as a strong hypothesis. Moreover, this work highlights the potential of the cinema market as an intriguing subject of analysis for econometricians, offering opportunities for further explorations.

<br>

# Annex

## Annex 1 ...

## Annex 2 - Test on the CSP models for the year before 1990

<center>**\\1990 and before**</center>

```{r Dataset_for_the_model_b90}
Econ_data_v2_1<- Econ_data_v2 %>% filter(year <= 1990)
```

### Test between OLS and Fixed Effect model

```{r Test_between_fixed_effect_and_OLS_b90}

#OLS Model
ols_b90 <- plm(entrées ~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2_1, index=c("departement_code", "year"), model="pooling")

#Fixed effect model
f_eff_b90 <-plm(entrées ~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2_1, index=c("departement_code", "year"), model="within")

# F Test for Individual and/or Time Effects test
pFtest(f_eff_b90, ols_b90)
```

### Test between Fixed and Random Model

```{r Test_between_fixed_and_random_effect_b90}
#Random effect model
r_eff_b90 <-plm(entrées ~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2_1, index=c("departement_code", "year"), model="random") 


#Haussman test to determine between fixed and random effect
phtest(f_eff_b90, r_eff_b90)
```

<br>

### Tests for time-fixed effect

```{r test_for_time_fixed_effect_b90}
#Model with time-fixed effects.
f_eff_time_b90 <-plm(entrées~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2_1, index=c("departement_code", "year"), model="within", effect = "time")

#PLM test
plmtest(f_eff_time_b90, effect="time", type="bp")
plmtest(f_eff_time_b90, effect="time", type="honda")
```

```{r}
f_eff_2ways_b90 <- plm(entrées~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2_1, index=c("departement_code", "year"), model="within",effect = "twoways")
```

<br>

### Test for unit roots

```{r Test_for_unit_roots_b90}
Panel.set<- pdata.frame(Econ_data_v2_1, index = c("departement_code", "year")) 

adf.test(Econ_data_v2_1$entrées, k=2)
```

<br>

### Test for serial correlation

```{r Test_for_serial_correlations_b90}
pbgtest(f_eff_2ways_b90)
```

<br>

### Test of Heterosedasticity

```{r #Test_for_heteroscedasticitys_b90}
bptest(entrées~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data = Econ_data_v2_1, studentize=F)
```

<br>

### Test for cross-sectional dependence

```{r Test_for_cross_sectional_dependences_b90}
#Breusch-Pagan LM test for cross-sectional dependence
pcdtest(f_eff_b90, test = c("lm"))

#Pesaran test for cross-sectional dependence
pcdtest(f_eff_b90, test = c("cd"))
```

<br>

### Annex 3 - Test on the CSP models for the year after 1990

<center>**Striclty after (1990)**</center>

```{r Dataset_for_the_model_a80}
Econ_data_v2_2<- Econ_data_v2 %>% filter(year > 1990)
```

### Test between OLS and Fixed Effect

```{r Test_between_fixed_effect_and_OLS_a90}

# OLS Model
ols_a90 <- plm(entrées ~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2_2, index=c("departement_code", "year"), model="pooling")

#Fixed effect model
f_eff_a90 <-plm(entrées ~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2_2, index=c("departement_code", "year"), model="within")

# F Test for Individual and/or Time Effects test
pFtest(f_eff_a90, ols_a90)
```

<br>

### Test between Fixed and Random effect model

```{r Test_between_fixed_and_random_effect_a90}
#Random effect model
r_eff_a90 <-plm(entrées ~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2_2, index=c("departement_code", "year"), model="random") 


#Haussman test to determine between fixed and random effect
phtest(f_eff_a90, r_eff_a90)
```

<br>

### Test for time-fixed effect

```{r test_for_time_fixed_effect_a90}
#Model with time-fixed effects.
f_eff_time_a90 <-plm(entrées~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2_2, index=c("departement_code", "year"), model="within", effect = "time")

#PLM test
plmtest(f_eff_time_a90, effect="time", type="bp")
plmtest(f_eff_time_a90, effect="time", type="honda")
```

```{r two_ways_model__specification_a90_annex}
f_eff_2ways_a90 <- plm(entrées~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data=Econ_data_v2_2, index=c("departement_code", "year"), model="within",effect = "twoways")
```

<br>

### Test for unit roots

```{r Test_for_unit_roots_a90}
Panel.set<- pdata.frame(Econ_data_v2_2, index = c("departement_code", "year")) 

adf.test(Econ_data_v2_2$entrées, k=2)
```

<br>

### Test for serial correlation

```{r Test_for_serial_correlation_a90}
pbgtest(f_eff_2ways_a90)
```

<br>

### Test of Heterosedasticity

```{r Test_for_heteroscedasticity_a90}
bptest(entrées~ Farm + Craf_sh_head + Ex_intel + Int_prof + Employees + Workers + Retirees + Ina, data = Econ_data_v2_2, studentize=F)
```

<br>

### Test for cross-sectional dependence

```{r Test_for_cross_sectional_dependence_a90}
#Breusch-Pagan LM test for cross-sectional dependence
pcdtest(f_eff_a90, test = c("lm"))

#Pesaran test for cross-sectional dependence
pcdtest(f_eff_a90, test = c("cd"))
```

<br>

# References

**ALTAF Ali, 2017.** *Panel Models*

URL : <https://altaf-ali.github.io/panel_data_models/>

<br>

**BLANCHARD Jean-Philippe, 2014.** " Multiplexes, public de banlieue et création cinématographique française : caractère marchand de l'ethnicité sur grand écran ". *Migrations Société*, 151, 153-164.

DOI : <https://doi.org/10.3917/migra.151.0153>

<br>

**BOURBONNAIS Régis, 2020.** " Chapitre 13. Introduction à l’économétrie des données de panel ", dans : ,*Économétrie.* Paris, Dunod, «Éco Sup», 2018, p. 371-387.

URL : <https://www.cairn.info/econometrie--9782100773459-page-371.htm>

<br>

**CNC, 2008.** " Evolution du public des salles de cinéma 1993-2007 ". *Les études du CNC*

<br>

**CNC, 2013.** " L'évolution du public des salles de cinéma 1993-2012 ". *Les études du CNC*, *septembre 2013*

<br>

**CNC, 2016.** " Les publics du cinéma 1993-2015 ", *Les études du CNC, septembre 2016*

<br>

**CNC, 2020.** *Observatoire de la diffusion et de la fréquentation cinématographiques - Indicateurs permanents Année 2018*

<br>

**CRETON Laurent, 2011.** " Économie du cinéma et multiplication des supports de diffusion. Le cas français entre exemplarité et incertitude ". *Le cinéma: permanences et métamorphoses*, 180, Raison présente, 2011.

<br>

**CROISSANT Yves, MILLO Giovanni, TAPPE Kevin, TOOMET Ott, KLEIBER Christian, ZEILEIS Achim, HENNINGSEN Arne, ANDRONIC Liviu & SCHOENFELDER Nina, 2023.** *Package 'plm'*

URL : <https://cran.r-project.org/web/packages/plm/plm.pdf>

<br>

**DURAND Jacques, 1960.** " Le film et son marché " . *Esprit, Nouvelle série*, No. 285 (6), pp. 1024-1033

URL: <https://www.jstor.org/stable/24255988>

<br>

**DUVAL Julien, 2011.** " L'offre et les goûts cinématographiques en France ". *Sociologie*, 2011/1 (Vol. 2), p. 1-18. DOI : 10.3917/socio.021.0001.

URL : <https://www.cairn.info/revue-sociologie-2011-1-page-1.htm>

<br>

**HAHN Nico, 2020.** *Making Maps with R.*

URL : <https://bookdown.org/nicohahn/making_maps_with_r5/docs/introduction.html>

<br>

**HANCK Christoph, ARNOLD Martin, GERBER Alexander & SCMELZER Martin, 2023.** *Introduction to econometrics with R*

URL : <https://www.econometrics-with-r.org/index.html>

<br>

**Insee, 2023.** *Consulter la PCS 2003 - Professions et catégories socioprofessionnelles - Catégorie socioprofessionnelle agrégée 4 : Professions Intermédiaires*

<br>

**MUHLBERGER David 2013.** *Cinema attendance during crises is there a relationship between cinema attendance and the state of the economy in France in the period 1992-2012?*

<br>

**Rstudio-pub-static.s3.amazonaws.com, unknown date of publication \[last consultation : 12/01/2024\]**. *Getting started in fixed/random effects models using r*

URL : <https://rstudio-pubs-static.s3.amazonaws.com/372492_3e05f38dd3f248e89cdedd317d603b9a.html>

<br>

**SCHMIDEINY Kurt, 2023.** *Panel data : Fixed and random effects*

<br>

**SHUAI Cao, 2020.** " La politique publique du cinéma en France (1981-2012) ". *Territoires contemporains - nouvelle série \[en ligne\]*, 2 septembre 2020,

URL: <http://tristan.u-bourgogne.fr/CGC/prodscientifique/TC.html>

<br>

**TORRES-REYNA Oscar**, 2010. Getting Started in Fixed/Random Effects Models using R/RStudio (v. 1.0)

URL : <https://www.princeton.edu/~otorres/Panel101R.pdf>

<br>

**TENNEKES Martijn, NOWOSAD Jakub, GOMBIN Joel, JEWORUTZKI Sebastian, RUSSELL Kent, ZIJDEMAN Richard, CLOUSE John, LOVELACE Robin, MUENCHOW Jannes, 2023.** *Package 'tmap'*

Url: <https://cran.r-project.org/web/packages/tmap/tmap.pdf>

<br>

**THIOLLIERE Michel & RALITE Jack au nom de la Commission des affaires culturelles du Sénat, 2003.** *L'évolution du secteur de l'exploitation cinématographique, Rapport d'information sénatoriale n°308 (2002-2003)*

URL: <https://www.senat.fr/rap/r02-308/r02-308_mono.html#toc5>

<br>

**WAGLE Manil, 2021.** *How to deal with Panel Data - Practical Application using R.* Medium.com

URL : [https://medium.com/\@manilwagle/how-to-deal-with-panel-data-practical-application-using-r-18ef95ae99c6](https://medium.com/@manilwagle/how-to-deal-with-panel-data-practical-application-using-r-18ef95ae99c6)

<br>

**YUM** **Minchul , 2022.** Model selection for panel data models with fixed effects: a simulation study, *Applied Economics Letters*, 29:19, p. 1776-1783

DOI: [10.1080/13504851.2021.1962505](https://doi.org/10.1080/13504851.2021.1962505)
